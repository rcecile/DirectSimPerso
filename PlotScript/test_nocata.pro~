PRO test_nocata,doplot

!p.charsize=2
!p.thick=3
!p.symsize=4
h= 0.679
h3 = h*h*h

loadct,39
restore,'temp_ascii.sav'        ; contient dir

err_tot=['_err0.03','_errP','_errPpodds','']
err=err_tot[2]
print,err

dir='/sps/lsst/data/rcecile/TJP_BAO_PS/'
suff='G2_'

D=['0.5','0.9','1.3','1.8'];,'1.8']
snx=['350','640','900','1024'];,'500']

window,0
plot,[0.04,0.2],[0.,20],/nodata,/xs,/ys,xra=[0.04,0.2],yra=[0,2],xtit='Wavenumber [Mpc^-1]',ytit='Power spectra ratio'
for iz=0,n_elements(D)-1 do begin

   name=dir+"PS_G2_"+snx[iz]+"_z"+D[iz]+err+"_nocata_wngal.txt"
   print,name
   result = FILE_TEST(name)
   if (result eq 0) then continue

   p1 = read_ascii(name, template =  TEMP_2FIT)     
   name=dir+"PS_G2_"+snx[iz]+"_z"+D[iz]+err+"_wngal.txt"
   print,(p1.(1))[5:10]
   print,name
   p0 = read_ascii(name, template =  TEMP_2FIT)     
   xs = p0.(0)
   
   oplot,xs,(p1.(1)-p1.(6))/(p0.(1)-p0.(6)),col=iz*70
endfor
legend,'z = '+D,box=1,col=findgen(n_elements(D))*70,line=0,/fill,/left,/bottom,charsize=2

window,3
plot,[0.04,0.2],[0.,20],/nodata,/xs,/ys,xra=[0.04,0.2],yra=[0,20],xtit='Wavenumber [Mpc^-1]',ytit='Power spectra ratio'
for iz=0,n_elements(D)-1 do begin
   name=dir+"PS_gauss_"+snx[iz]+"_z"+D[iz]+err+"_wngal.txt"
   print,name
   result = FILE_TEST(name)
   if (result eq 0) then continue
   p1 = read_ascii(name, template =  TEMP_2FIT)  

   name=dir+"PS_specz_"+snx[iz]+"_z"+D[iz]+err+"_wngal.txt"
   print,name
   result = FILE_TEST(name)
   if (result eq 0) then continue

   p2 = read_ascii(name, template =  TEMP_2FIT)  
    
   name=dir+"PS_G2_"+snx[iz]+"_z"+D[iz]+err+"_wngal.txt"
   print,(p1.(1))[5:10]
   print,name
   p0 = read_ascii(name, template =  TEMP_2FIT)     

   xs = p0.(0)
   oplot,xs,(p1.(1)-p1.(6))/(p0.(1)-p0.(6)),col=iz*70
   oplot,xs,(p2.(1)-p2.(6))/(p0.(1)-p0.(6)),col=iz*70,li=2
   read,xx
endfor
legend,'z = '+D,box=1,col=findgen(n_elements(D))*70,line=0,/fill,/left,/bottom,charsize=2
;write_jpeg,'/sps/lsst/dev/rcecile/BAO_InOut/ps_sfspec.jpg',tvrd(true=3),true=3


END
