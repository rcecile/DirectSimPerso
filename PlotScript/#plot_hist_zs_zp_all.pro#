PRO plot_hist_zs_zp_all,doplot,isuff

dir='/sps/lsst/data/rcecile/TJP_BAO/'
loadct,39

suff = ['_errPpodds','_errPBDT','_errP','_err0.03']
nsuff = ['_errPpodds','_errPBDT','_errP','_errG']
mytit = ['',' with ODDS cut',' with BDT cut','with Gaussian error']
 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

restore,dir+'histo_zs_zp'+suff[isuff]+'.sav'
lhp = alog10(double(all_hist))
binz=0.01
zmax=3.
z=findgen(zmax/binz+1)*binz

ws = 600
myc = findgen(12)/2.
mycdiv = 42.

myc = findgen(6)
mycdiv = 50.

im=contour(lhp,z,z,xtit='spectroZ',ytit='photoZ'+mytit[isuff],/fill,POSITION=[0.12,0.2,0.97,0.93],FONT_SIZE=15,$
           RGB_INDICES=myc*mycdiv, C_VALUE=myc,RGB_TABLE=39, DIM=[ws,ws*1.225],xticklen=1,yticklen=1,xsubticklen=.025,ysubticklen=.025)
cb = COLORBAR(TARGET=im,POSITION=[0.1,0.08,0.95,0.12],  TITLE='log(Ngal) with redshift bin width = 0.01',FONT_SIZE=15)

if (doplot eq 1) then im.Save, "/sps/lsst/dev/rcecile/Fig/stat_zs_zp"+nsuff[isuff]+".pdf"
 
diff_bin=0.001
diff_max=3.
idx=findgen(diff_max/diff_bin*2+1)
x = -diff_max + idx*diff_bin
idx1 = where( abs(x) lt 0.01)
idx3 = where( abs(x) lt 0.03)
idx5 = where( abs(x) lt 0.05)
idx9 = where( abs(x) lt 0.09)
tot=total(hpdiff)
print,' '
print,'[%] within 0.01, 0.03, 0.05, 0.09 for z_p'
print,total(hpdiff[idx1])/tot*100,total(hpdiff[idx3])/tot*100,total(hpdiff[idx5])/tot*100,total(hpdiff[idx9])/tot*100,format='(f4.0)'

print,'PODDS'
print,' '
print,'[%] within 0.01, 0.03, 0.05, 0.09 for z_d compared to zp'
print,total(hddiff[idx1])/tot*100,total(hddiff[idx3])/tot*100,total(hddiff[idx5])/tot*100,total(hddiff[idx9])/tot*100,format='(f4.0)'
tot=total(hddiff)
print,' '
print,'[%] within 0.01, 0.03, 0.05, 0.09 for z_d compared to zd'
print,total(hddiff[idx1])/tot*100,total(hddiff[idx3])/tot*100,total(hddiff[idx5])/tot*100,total(hddiff[idx9])/tot*100,format='(f4.0)'


END

