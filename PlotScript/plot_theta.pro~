PRO plot_theta

loadct,39
!p.thick=3


theta= dindgen(6000)/100.
rtheta = theta *!pi/180.

ht = dindgen(6000,5)
for slice=5,50,10 do begin
   m=mrdfits("/sps/lsst/data/rcecile/TJP_BAO/cat_G2_Slice" + strtrim(slice,2)+".fits",1,head)
   stheta = m.(2)
   
   h = histogram(stheta,min=0,max=max(rtheta),bin=0.01*!pi/180.)
   for i=0,5999 do ht[i,slice/10] = total(h[0:i])

endfor


window,2
plot,theta,[1,.7e8],/nodata,/xs,/ys,tit='Ngal avec theta < Theta',xtit='Theta',ytit='Ngal';,xra=[0,10]
for i=0,4 do   oplot,theta,ht[*,i],col=i*50
write_jpeg,'/sps/lsst/dev/rcecile/BAO_InOut/Ngal_theta.jpg' ,tvrd(true=3),true=3


window,4
plot,theta,[0,.7e8],/nodata,/xs,/ys,tit='Ngal avec theta < Theta / tan^2',xtit='Theta';,xra=[0,10]
for i=0,4 do   oplot,theta,ht[*,i]/tan(rtheta)/tan(rtheta),col=i*50
write_jpeg,'/sps/lsst/dev/rcecile/BAO_InOut/geometrie_theta.jpg' ,tvrd(true=3),true=3

window,3
plot,theta,2.*(1-cos(rtheta)),yra=[1e-3,1],tit='noir = surface coquille, vert = surface disque, meme redshift',xtit='Theta'
oplot,theta,tan(rtheta)*tan(rtheta),col=123
;write_jpeg,'/sps/lsst/dev/rcecile/BAO_InOut/Ngal_geometrie.jpg' ,tvrd(true=3),true=3

stop


END
